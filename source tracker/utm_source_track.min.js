(function () {
  // Define the addQueryParameters function
  function addQueryParameters() {
    const urlParams = new URLSearchParams(window.location.search);
    const utmSourceParam = urlParams.get('utm_source');

    if (utmSourceParam) {
      // If 'utm_source' parameter is present in the URL, store it in local storage
      localStorage.setItem('utm_source', utmSourceParam);
    } else {
      // If 'utm_source' parameter is not present in the URL, retrieve it from local storage
      const storedUTMSource = localStorage.getItem('utm_source');

      if (storedUTMSource) {
        // Append stored 'utm_source' to the URL query parameters
        urlParams.set('utm_source', storedUTMSource);

        // Update the URL with the appended 'utm_source' parameter
        const newUrl = `${window.location.origin}${window.location.pathname}?${urlParams.toString()}`;

        // Redirect to the updated URL
        window.location.href = newUrl;
      }
    }
  }

  console.log("storing utm_source");
  addQueryParameters();
})();
